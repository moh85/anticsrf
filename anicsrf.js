/**** antiCSRF v1.0 by Mohammad Atwi ****/
function antiCSRF(data, option = { target: 'form'}){ function addInputs(target){ $.each(data, function(name, val){ $('[name="'+name+'"]', target).remove(); $('<input/>').attr('type', 'hidden').attr('name', name).attr('value', val).appendTo(target); }); } $.ajaxSetup({ data: data }); addInputs(option.target); $(document).on('submit', option.target, function(){ addInputs(this); return true; }); }
